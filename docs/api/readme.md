# API 设计最佳实践

- https://mp.weixin.qq.com/s/YgaYLyqCJQ-bXoA5F5ygxg

任何API设计都遵循一种叫做“面向资源设计”的原则：

- 资源：资源是数据的一部分，例如：用户
- 集合：一组资源称为集合，例如：用户列表
- URL：标识资源或集合的位置，例如：/user

1. 对URL使用kebab-case（短横线小写隔开形式）`/system-orders`
2. 参数使用camelCase（驼峰形式）`/system-orders/{orderId}`
3. 指向集合的复数名称 `GET /users`
4. URL以集合开始，以标识符结束 `GET /shops/:shopId/或GET /category/:categoryId`
   1. 保持概念的单一性和一致性
5. 让动词远离你的资源URL `PUT /user/{userId}`
   1. 不要在URL中使用动词来表达你的意图。相反，使用适当的HTTP方法来描述操作。
6. 对非资源URL使用动词 `POST /alarm/245743/resend`
   1. 如果你有一个端点，它只返回一个操作。在这种情况下，你可以使用动词。例如，如果你想要向用户重新发送警报。
   2. 请记住，这些不是我们的CRUD操作。相反，它们被认为是在我们的系统中执行特定工作的函数。
7. JSON属性使用camelCase驼峰形式
   1. 如果你正在构建一个请求体或响应体为JSON的系统，那么属性名应该使用驼峰大小写。
8. 监控
   1. RESTful HTTP服务必须实现/health和/version和/metricsAPI端点。他们将提供以下信息。
   2. /health 用200 OK状态码响应对/health的请求。
   3. /version 用版本号响应对/version的请求。
   4. /metrics 这个端点将提供各种指标，如平均响应时间。
   5. 也强烈推荐使用/debug和/status端点。
9. 不要使用table_name作为资源名
   1. 不要只使用表名作为资源名。从长远来看，这种懒惰是有害的。
10. 使用API设计工具
11. 使用简单序数作为版本
12. 在你的响应体中包括总资源数
13. 接受limit和offset参数
14. 获取字段查询参数
15. 不要在URL中通过认证令牌
16. 验证内容类型
17. 对CRUD函数使用HTTP方法
18. 在嵌套资源的URL中使用关系
19. CORS（跨源资源共享）
20. 安全(强制并要求所有回调url、推送通知端点和webhooks使用HTTPS。)
21. 错误
    1. 当由于一个或多个服务错误而拒绝客户端请求时，一定要返回4xx HTTP错误代码。
    2. 考虑处理所有属性，然后在单个响应中返回多个验证问题。
22. 黄金法则
    1. 如果您对API格式的决定有疑问，这些黄金规则可以帮助我们做出正确的决定。
    2. 扁平比嵌套好。
    3. 简单胜于复杂。
    4. 字符串比数字好。
    5. 一致性比定制更好。
